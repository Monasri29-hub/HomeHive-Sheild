<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Emotion Detector • HomeHive</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
    body {
        margin:0;
        font-family: "Segoe UI", sans-serif;
        background: radial-gradient(circle at top, #0d101c, #020409 70%);
        color:white;
        overflow-x:hidden;
    }

    /* NAVBAR */
    nav {
        display:flex;
        justify-content:space-between;
        padding:18px 40px;
        position:sticky;
        top:0;
        z-index:100;
        background:rgba(0,0,0,0.35);
        backdrop-filter:blur(12px);
        border-bottom:1px solid rgba(255,255,255,0.05);
    }

    nav a {
        color:#c8d2ff;
        text-decoration:none;
        margin:0 14px;
        font-size:17px;
        transition:0.2s;
    }

    nav a:hover {
        color:#fff;
    }

    .logo {
        height:42px;
    }

    /* MAIN GRID */
    .wrap {
        max-width:1250px;
        margin:50px auto;
        padding:20px;
        display:grid;
        grid-template-columns: 1fr 380px;
        gap:32px;
        align-items:start;
    }

    .card {
        background:linear-gradient(180deg, rgba(255,255,255,0.018), rgba(255,255,255,0.008));
        border:1px solid rgba(255,255,255,0.03);
        border-radius:20px;
        padding:35px;
        box-shadow:0 30px 80px rgba(2,6,12,0.5);
        animation:fadeIn 1s ease forwards;
    }

    @keyframes fadeIn {
        from { opacity:0; transform:translateY(10px); }
        to   { opacity:1; transform:translateY(0); }
    }

    .title {
        font-size:38px;
        font-weight:700;
        margin-bottom:10px;
        background:linear-gradient(90deg,#4acbff,#e66bff);
        -webkit-background-clip:text;
        background-clip:text;
        -webkit-text-fill-color:transparent;
    }

    .subtitle {
        font-size:18px;
        opacity:0.7;
        margin-bottom:35px;
    }

    .scanner {
        width:400px;
        height:400px;
        border-radius:50%;
        margin:0 auto;
        position:relative;
        border:3px solid rgba(0,255,255,0.3);
        box-shadow:
            0 0 20px rgba(0,255,255,0.3),
            0 0 40px rgba(255,0,255,0.2),
            0 0 80px rgba(0,180,255,0.15);
        overflow:hidden;
        display:flex;
        align-items:center;
        justify-content:center;
    }

    .scanner img {
        width:100%;
        height:100%;
        border-radius:50%;
        object-fit:cover;
    }

    .ring {
        position:absolute;
        width:100%;
        height:100%;
        border-radius:50%;
        border:3px dashed rgba(0,255,255,0.4);
        animation:spin 6s linear infinite;
    }

    @keyframes spin {
        0% { transform:rotate(0deg); }
        100% { transform:rotate(360deg); }
    }

    .sweep, .sweep2 {
        position:absolute;
        width:100%;
        height:100%;
        border-radius:50%;
        pointer-events:none;
        overflow:hidden;
    }

    .sweep::before {
        content:"";
        position:absolute;
        top:-40%;
        left:50%;
        width:12px;
        height:180%;
        background:linear-gradient(180deg, rgba(0,255,255,1), rgba(255,0,255,0));
        border-radius:50%;
        filter:blur(6px);
        animation:sweep-rotate 4s linear infinite;
        transform-origin:bottom center;
    }

    @keyframes sweep-rotate {
        0% { transform:translateX(-50%) rotate(0deg); }
        100% { transform:translateX(-50%) rotate(360deg); }
    }

    .sweep2::before {
        content:"";
        position:absolute;
        top:-40%;
        left:50%;
        width:8px;
        height:180%;
        background:linear-gradient(180deg, rgba(255,0,255,1), rgba(0,255,255,0));
        border-radius:50%;
        filter:blur(6px);
        animation:sweep2-rotate 6s linear infinite reverse;
        transform-origin:bottom center;
    }

    @keyframes sweep2-rotate {
        0% { transform:translateX(-50%) rotate(0deg); }
        100% { transform:translateX(-50%) rotate(360deg); }
    }

    .particle {
        position:absolute;
        width:6px;
        height:6px;
        background:#8af8ff;
        border-radius:50%;
        opacity:0.6;
        animation:float 5s infinite ease-in-out;
    }

    @keyframes float {
        0% { transform:translateY(0) scale(1); opacity:0.4; }
        50% { transform:translateY(-18px) scale(1.3); opacity:1; }
        100% { transform:translateY(0) scale(1); opacity:0.4; }
    }

    .upload-btn, .scan-btn {
        display:block;
        margin:20px auto;
        width:220px;
        padding:14px;
        font-size:16px;
        font-weight:700;
        border-radius:10px;
        cursor:pointer;
        border:none;
        background:linear-gradient(90deg,#00d4ff,#ff4bf0);
        color:#000;
        transition:0.3s;
    }

    .upload-btn:hover, .scan-btn:hover {
        transform:scale(1.05);
    }

    .hidden {
        display:none;
    }

    .scan-time {
        text-align:center;
        opacity:0.6;
        margin-top:8px;
    }

    .side {
        display:flex;
        flex-direction:column;
        gap:30px;
    }

    .panel {
        background:rgba(255,255,255,0.03);
        padding:20px;
        border-radius:14px;
        border:1px solid rgba(255,255,255,0.05);
    }

    .panel h3 {
        margin:0 0 10px;
    }

    .emotion-box {
        font-size:26px;
        font-weight:700;
        background:linear-gradient(90deg,#3ecbff,#ff5de6);
        -webkit-background-clip:text;
         background-clip:text;
        -webkit-text-fill-color:transparent;
    }
</style>
</head>

<body>

<nav>
    <img src="logo.png" class="logo">
    <div>
        <a href="index.html">Home</a>
        <a href="dashboard.html">Dashboard</a>
        <a href="modules.html">Modules</a>
        <a href="phishing.html">Phishing</a>
        <a href="security.html">Security</a>
    </div>
</nav>

<div class="wrap">

    <div class="card">
        <div class="title">Emotion Detector</div>
        <div class="subtitle">Upload a face image for AI-powered mood scanning.</div>

        <div class="scanner" id="scanCircle">
            <div class="ring"></div>
            <div class="sweep"></div>
            <div class="sweep2"></div>
            <img id="preview" src="" class="hidden">
        </div>

        <input type="file" id="imgInput" accept="image/*" class="hidden">
        <div class="upload-btn" onclick="imgInput.click()">Choose photo</div>
        <button class="scan-btn" onclick="scanEmotion()">Scan Emotion</button>
        <div class="scan-time" id="scanTime"></div>
    </div>

    <div class="side">

        <div class="panel">
            <h3>Detected Emotion</h3>
            <div class="emotion-box" id="emotionText">—</div>
        </div>

        <div class="panel">
            <h3>Lighting Recommendation</h3>
            <div id="lightReco">—</div>
        </div>

        <div class="panel">
            <h3>Music Recommendation</h3>
            <div id="musicReco">—</div>
        </div>

    </div>

</div>

<script>
let imgInput = document.getElementById("imgInput");
let preview = document.getElementById("preview");
let scanTime = document.getElementById("scanTime");
let emotionText = document.getElementById("emotionText");
let lightReco = document.getElementById("lightReco");
let musicReco = document.getElementById("musicReco");
let scanCircle = document.getElementById("scanCircle");

imgInput.addEventListener("change", () => {
    let file = imgInput.files[0];
    preview.src = URL.createObjectURL(file);
    preview.classList.remove("hidden");
});

function scanEmotion() {
    let file = imgInput.files[0];
    if (!file) {
        alert("Upload an image first!");
        return;
    }

    let fd = new FormData();
    fd.append("image", file);

    fetch("http://127.0.0.1:5000/analyze", {
        method:"POST",
        body:fd
    })
    .then(res => res.json())
    .then(data => {
        let emo = (data.emotion || "UNKNOWN").toUpperCase();
        emotionText.innerText = emo;
        scanTime.innerText = "Last scan: " + new Date().toLocaleTimeString();

        const glowColors = {
            HAPPY:"0 0 40px rgba(255,200,0,0.7)",
            SAD:"0 0 40px rgba(0,120,255,0.7)",
            ANGRY:"0 0 40px rgba(255,0,80,0.8)",
            FEAR:"0 0 40px rgba(255,255,255,0.7)",
            DISGUST:"0 0 40px rgba(0,255,100,0.7)",
            SURPRISE:"0 0 40px rgba(255,0,255,0.7)",
            NEUTRAL:"0 0 40px rgba(180,180,255,0.5)"
        };

        scanCircle.style.boxShadow = glowColors[emo] || "0 0 40px rgba(255,255,255,0.3)";

        const rec = {
            HAPPY:{light:"Warm ambient lighting (3000K).", music:"Upbeat lo-fi / indie pop (100 BPM)."},
            SAD:{light:"Cozy warm dim lights.", music:"Calming piano or strings (60 BPM)."},
            ANGRY:{light:"Cool white to reduce temperature.", music:"Slow chilled beats."},
            FEAR:{light:"Neutral soft lighting.", music:"Gentle acoustic tracks."},
            DISGUST:{light:"Clean bright white light.", music:"Neutral ambient pads."},
            SURPRISE:{light:"Dynamic hue-shifting lights.", music:"Light electronic playful music."},
            NEUTRAL:{light:"Normal soft-white home lighting.", music:"Calm lo-fi or ambient."}
        };

        lightReco.innerText = rec[emo]?.light || "—";
        musicReco.innerText = rec[emo]?.music || "—";
    });
}
</script>

</body>
</html>
